<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of CalibrateModelGenerationNum</title>
  <meta name="keywords" content="CalibrateModelGenerationNum">
  <meta name="description" content="Generation of the calibrated musculoskeletal model">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html Functions --><!-- menu.html Calibration -->
<h1>CalibrateModelGenerationNum
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Generation of the calibrated musculoskeletal model</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [] = CalibrateModelGenerationNum(ModelParameters,AnalysisParameters) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Generation of the calibrated musculoskeletal model
   A subject-specific model is generated. Additionnal computations used
   for the analysis are also made.

    Associated publication:
    - Muller, A., Haering, D., Pontonnier, C., &amp; Dumont, G., 2017. 
    Non-invasive techniques for musculoskeletal model calibration. In 23�me Congr�s Fran�ais de M�canique.

   INPUT
   - ModelParameters: parameters of the musculoskeletal model,
   automatically generated by the graphic interface 'GenerateParameters';
   - AnalysisParameters: parameters of the musculoskeletal analysis,
   automatically generated by the graphic interface 'Analysis'.
   OUTPUT
   The musculoskeletal model is automatically saved in the variable
   'BiomechanicalModel'.
   In this numerical version, the moment arms are no longer computed
   analytically. The MusIC method is no longer activated
________________________________________________________

 Licence
 Toolbox distributed under Licence GPL 3.0
________________________________________________________

 Authors : Antoine Muller, Charles Pontonnier, Pierre Puchaud and
 Georges Dumont
________________________________________________________</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="CalibratePatellaJoint.html" class="code" title="function [BiomechanicalModel]=CalibratePatellaJoint(BiomechanicalModel)">CalibratePatellaJoint</a>	Generation of the function between Knee Angle and Patella Angle with the</li><li><a href="../../Functions/Calibration/Dynamics/DynamicCalibration.html" class="code" title="function [BiomechanicalModel] = DynamicCalibration(ModelParameters,AnalysisParameters, BiomechanicalModel)">DynamicCalibration</a>	Calibration of the inertial parameters</li><li><a href="../../Functions/Calibration/Geometrical/GeometricalCalibration.html" class="code" title="function [Human_model_calib, calib_parameters, Markers_set] = GeometricalCalibration(OsteoArticularModel, Markers_set, AnalysisParameters)">GeometricalCalibration</a>	Calibration of the geometrical parameters</li><li><a href="../../Functions/Calibration/Muscle/MuscleCalibrationAnthropo.html" class="code" title="function [BiomechanicalModelscaled]=MuscleCalibrationAnthropo(ModelParameters,AnalysisParameters,BiomechanicalModel)">MuscleCalibrationAnthropo</a>	% Model of reference</li><li><a href="../../Functions/DataImport/InputDataImport/MVNX_V3.html" class="code" title="function [varargout] = MVNX_V3(varargin)">MVNX_V3</a>	Import MVNX file</li><li><a href="../../Functions/Kinematics/Add6dof.html" class="code" title="function [Human_model] = Add6dof(Human_model)">Add6dof</a>	Addition of a 6 dof joint</li><li><a href="../../Functions/Kinematics/SymbolicFunctionGenerationIK.html" class="code" title="function [Human_model,Jacob,Generalized_Coordinates]=SymbolicFunctionGenerationIK(Human_model,Markers_set)">SymbolicFunctionGenerationIK</a>	Computation of function used in the inverse kinematics step</li><li><a href="../../Functions/Models/ModelGeneration.html" class="code" title="function [OsteoArticularModel, Markers, Muscles, EnableModel] = ModelGeneration(ModelParameters)">ModelGeneration</a>	Generation of the anthropometric model</li><li><a href="../../Functions/MuscleForces/MomentArmsComputationInit.html" class="code" title="function [C] = MomentArmsComputationInit(BiomechanicalModel,q0,dp)">MomentArmsComputationInit</a>	Computation of the moment arms matrix (numerical version)</li><li><a href="../../Functions/MuscleForces/Wrapping/WrappingLocations.html" class="code" title="function [BiomechanicalModel]=WrappingLocations(BiomechanicalModel)">WrappingLocations</a>	Location of where are wraps</li><li><a href="../../Functions/XSens/MVNXModelGeneration.html" class="code" title="function [OsteoArticularModel] = MVNXModelGeneration(ModelParameters, AnalysisParameters)">MVNXModelGeneration</a>	Generation of the osteo-articular model from a MVNX file</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../Functions/Main.html" class="code" title="">Main</a>	Main script of the Toolbox</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [] = CalibrateModelGenerationNum(ModelParameters,AnalysisParameters)</a>
0002 <span class="comment">% Generation of the calibrated musculoskeletal model</span>
0003 <span class="comment">%   A subject-specific model is generated. Additionnal computations used</span>
0004 <span class="comment">%   for the analysis are also made.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%    Associated publication:</span>
0007 <span class="comment">%    - Muller, A., Haering, D., Pontonnier, C., &amp; Dumont, G., 2017.</span>
0008 <span class="comment">%    Non-invasive techniques for musculoskeletal model calibration. In 23�me Congr�s Fran�ais de M�canique.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   INPUT</span>
0011 <span class="comment">%   - ModelParameters: parameters of the musculoskeletal model,</span>
0012 <span class="comment">%   automatically generated by the graphic interface 'GenerateParameters';</span>
0013 <span class="comment">%   - AnalysisParameters: parameters of the musculoskeletal analysis,</span>
0014 <span class="comment">%   automatically generated by the graphic interface 'Analysis'.</span>
0015 <span class="comment">%   OUTPUT</span>
0016 <span class="comment">%   The musculoskeletal model is automatically saved in the variable</span>
0017 <span class="comment">%   'BiomechanicalModel'.</span>
0018 <span class="comment">%   In this numerical version, the moment arms are no longer computed</span>
0019 <span class="comment">%   analytically. The MusIC method is no longer activated</span>
0020 <span class="comment">%________________________________________________________</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% Licence</span>
0023 <span class="comment">% Toolbox distributed under Licence GPL 3.0</span>
0024 <span class="comment">%________________________________________________________</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% Authors : Antoine Muller, Charles Pontonnier, Pierre Puchaud and</span>
0027 <span class="comment">% Georges Dumont</span>
0028 <span class="comment">%________________________________________________________</span>
0029 
0030 <span class="comment">%% Model generation from a MVNX file</span>
0031 <span class="keyword">if</span> isequal(AnalysisParameters.General.InputData, @<a href="../../Functions/DataImport/InputDataImport/MVNX_V3.html" class="code" title="function [varargout] = MVNX_V3(varargin)">MVNX_V3</a>)
0032     disp(<span class="string">'Model Generation ...'</span>)
0033     <a href="../../Functions/XSens/MVNXModelGeneration.html" class="code" title="function [OsteoArticularModel] = MVNXModelGeneration(ModelParameters, AnalysisParameters)">MVNXModelGeneration</a>(ModelParameters, AnalysisParameters);
0034     disp(<span class="string">'... Model Generation done'</span>)
0035     <span class="keyword">return</span>;
0036 <span class="keyword">end</span>
0037 
0038 <span class="comment">%% Anthropometric model generation</span>
0039 disp(<span class="string">'Anthropometric Model Generation ...'</span>)
0040 [BiomechanicalModel.OsteoArticularModel, BiomechanicalModel.Markers, BiomechanicalModel.Muscles] = <a href="../../Functions/Models/ModelGeneration.html" class="code" title="function [OsteoArticularModel, Markers, Muscles, EnableModel] = ModelGeneration(ModelParameters)">ModelGeneration</a>(ModelParameters);
0041 disp(<span class="string">'... Anthropometric Model Generation done'</span>)
0042 
0043 <span class="comment">%% Geometrical calibration</span>
0044 <span class="keyword">if</span> AnalysisParameters.CalibIK.Active
0045     disp(<span class="string">'Geometrical Calibration ...'</span>)
0046     [BiomechanicalModel.OsteoArticularModel, BiomechanicalModel.GeometricalCalibration, BiomechanicalModel.Markers] = <a href="../../Functions/Calibration/Geometrical/GeometricalCalibration.html" class="code" title="function [Human_model_calib, calib_parameters, Markers_set] = GeometricalCalibration(OsteoArticularModel, Markers_set, AnalysisParameters)">GeometricalCalibration</a>(BiomechanicalModel.OsteoArticularModel, BiomechanicalModel.Markers, AnalysisParameters);
0047     disp(<span class="string">'... Geometrical Calibration done'</span>)
0048 <span class="keyword">end</span>
0049 
0050 <span class="comment">%% Joint Calibration</span>
0051 <span class="keyword">if</span> ~isempty(find(contains(<span class="keyword">...</span>
0052         {BiomechanicalModel.OsteoArticularModel.name}',<span class="string">'Patella'</span>), 1))
0053     disp(<span class="string">'Joint Calibration ...'</span>)
0054     [BiomechanicalModel]=<a href="CalibratePatellaJoint.html" class="code" title="function [BiomechanicalModel]=CalibratePatellaJoint(BiomechanicalModel)">CalibratePatellaJoint</a>(BiomechanicalModel);
0055     disp(<span class="string">'... Joint Calibration done'</span>)
0056 <span class="keyword">end</span>
0057 
0058 <span class="comment">%% Symbolic functions</span>
0059 disp(<span class="string">'Preliminary Computations ...'</span>)
0060 [BiomechanicalModel.OsteoArticularModel] = <a href="../../Functions/Kinematics/Add6dof.html" class="code" title="function [Human_model] = Add6dof(Human_model)">Add6dof</a>(BiomechanicalModel.OsteoArticularModel);
0061 [BiomechanicalModel.OsteoArticularModel, BiomechanicalModel.Jacob,<span class="keyword">...</span>
0062     BiomechanicalModel.Generalized_Coordinates] = <a href="../../Functions/Kinematics/SymbolicFunctionGenerationIK.html" class="code" title="function [Human_model,Jacob,Generalized_Coordinates]=SymbolicFunctionGenerationIK(Human_model,Markers_set)">SymbolicFunctionGenerationIK</a>(BiomechanicalModel.OsteoArticularModel,BiomechanicalModel.Markers);
0063 disp(<span class="string">'... Preliminary Computations done'</span>)
0064 
0065 <span class="comment">%% Inertial calibration</span>
0066 <span class="keyword">if</span> AnalysisParameters.CalibID.Active
0067     disp(<span class="string">'Dynamic Calibration ...'</span>)
0068     [BiomechanicalModel] = <a href="../../Functions/Calibration/Dynamics/DynamicCalibration.html" class="code" title="function [BiomechanicalModel] = DynamicCalibration(ModelParameters,AnalysisParameters, BiomechanicalModel)">DynamicCalibration</a>(ModelParameters,AnalysisParameters, BiomechanicalModel);
0069     disp(<span class="string">'... Dynamic Calibration done'</span>)
0070 <span class="keyword">end</span>
0071 
0072 <span class="comment">%% Moment arms matrix et muscular coupling</span>
0073 <span class="comment">% not applicable here</span>
0074 <span class="comment">% if numel(BiomechanicalModel.Muscles)</span>
0075 <span class="comment">%     disp('Moment Arms Computation ...')</span>
0076 <span class="comment">%     [BiomechanicalModel.MomentArms,BiomechanicalModel.MuscularCoupling] =...</span>
0077 <span class="comment">%         MomentArmsComputation(BiomechanicalModel);</span>
0078 <span class="comment">%     disp('... Moment Arms Computation done');</span>
0079 <span class="comment">% end</span>
0080 
0081 <span class="comment">%% Generation of the data base for computation of muscular forces by using MusIC method</span>
0082 <span class="comment">% Not available here</span>
0083 <span class="comment">% if numel(BiomechanicalModel.Muscles) &amp;&amp; AnalysisParameters.Muscles.Method == 2</span>
0084 <span class="comment">%     disp('MusIC Database Generation ...')</span>
0085 <span class="comment">%     eval(['[BiomechanicalModel.MusICDatabase_' char(AnalysisParameters.Muscles.Costfunction) num2str(AnalysisParameters.Muscles.CostfunctionOptions) '_' num2str(AnalysisParameters.Muscles.DatabaseDensity(1)) '_' num2str(AnalysisParameters.Muscles.DatabaseDensity(2)) '] = MusICDatabaseGeneration(BiomechanicalModel, AnalysisParameters);'])</span>
0086 <span class="comment">%     disp('... MusIC Database Generation done')</span>
0087 <span class="comment">% end</span>
0088 
0089  <span class="comment">%% Wrapping locations</span>
0090  <span class="keyword">if</span> ~isempty([BiomechanicalModel.Muscles])
0091     <span class="keyword">if</span> ~isempty([BiomechanicalModel.Muscles.wrap]')
0092          [BiomechanicalModel] =<span class="keyword">...</span>
0093              <a href="../../Functions/MuscleForces/Wrapping/WrappingLocations.html" class="code" title="function [BiomechanicalModel]=WrappingLocations(BiomechanicalModel)">WrappingLocations</a>(BiomechanicalModel);
0094     <span class="keyword">end</span>
0095  <span class="keyword">end</span>
0096  
0097  <span class="comment">%% Muscular coupling computation</span>
0098 q=zeros(numel(BiomechanicalModel.OsteoArticularModel(:))-6,1)+0.01;
0099 dp=0.001;
0100 
0101 
0102  <span class="keyword">if</span> numel(BiomechanicalModel.Muscles)
0103      disp(<span class="string">'Muscular Coupling Computation ...'</span>)
0104      [BiomechanicalModel.Coupling] =<span class="keyword">...</span>
0105          <a href="../../Functions/MuscleForces/MomentArmsComputationInit.html" class="code" title="function [C] = MomentArmsComputationInit(BiomechanicalModel,q0,dp)">MomentArmsComputationInit</a>(BiomechanicalModel,q,dp);
0106      disp(<span class="string">'... Muscular Coupling Computation done'</span>);
0107  <span class="keyword">end</span>
0108 
0109  <span class="comment">%% Muscular calibration</span>
0110  <span class="keyword">if</span> ~isempty([BiomechanicalModel.Muscles])
0111     [BiomechanicalModel]=<a href="../../Functions/Calibration/Muscle/MuscleCalibrationAnthropo.html" class="code" title="function [BiomechanicalModelscaled]=MuscleCalibrationAnthropo(ModelParameters,AnalysisParameters,BiomechanicalModel)">MuscleCalibrationAnthropo</a>(ModelParameters,AnalysisParameters,BiomechanicalModel);
0112  <span class="keyword">end</span>
0113  
0114  
0115 save(<span class="string">'BiomechanicalModel'</span>,<span class="string">'BiomechanicalModel'</span>);
0116 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 28-Apr-2021 14:02:00 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>