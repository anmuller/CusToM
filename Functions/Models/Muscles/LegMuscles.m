function [Muscles]=LegMuscles(Muscles,Signe)
% Definition of a leg muscle model
%   This model contains 41 muscles, actuating the hip, the knee and the
%   ankle joint
%
%	Based on:
%	- Damsgaard, M., Rasmussen, J., Christensen, S. T., Surma, E., & De Zee, M., 2006.
% 	Analysis of musculoskeletal systems in the AnyBody Modeling System. Simulation Modelling Practice and Theory, 14(8), 1100-1111.
%
%   INPUT
%   - Muscles: set of muscles (see the Documentation for the structure)
%   - Signe: side of the leg model ('R' for right side or 'L' for left side)
%   OUTPUT
%   - Muscles: new set of muscles (see the Documentation for the structure)
%________________________________________________________
%
% Licence
% Toolbox distributed under GPL 3.0 Licence
%________________________________________________________
%
% Authors : Antoine Muller, Charles Pontonnier, Pierre Puchaud and
% Georges Dumont
%________________________________________________________
if strcmp(Signe,'Right')
    Signe = 'R';
else
    Signe = 'L';
end

s=cell(0);

% Hip
s=[s;{
    [Signe 'GluteusMinimus1'],180,0.068,18.8679,0.043753,10,{['GluteusMinimus1' Signe 'Pelvis'];['GluteusMinimus' Signe 'Thigh']},{};...
    [Signe 'GluteusMinimus2'],190,0.056,18.8679,0.071033,0,{['GluteusMinimus2' Signe 'Pelvis'];['GluteusMinimus' Signe 'Thigh']},{};...
    [Signe 'GluteusMinimus3'],215,0.038,18.8679,0.097636,1,{['GluteusMinimus3' Signe 'Pelvis'];['GluteusMinimus' Signe 'Thigh']},{};...
    [Signe 'GluteusMedius1'],550,0.054,18.8679,0.075872,8,{['GluteusMedius1' Signe 'Pelvis'];['GluteusMedius' Signe 'Thigh']},{};...
    [Signe 'GluteusMedius2'],380,0.084,18.8679,0.089783,0,{['GluteusMedius2' Signe 'Pelvis'];['GluteusMedius' Signe 'Thigh']},{};...
    [Signe 'GluteusMedius3'],435,0.065,18.8679,0.12195,19,{['GluteusMedius3' Signe 'Pelvis'];['GluteusMedius' Signe 'Thigh']},{};...
    [Signe 'AdductorLongus'],420,0.138,18.8679,0.057659,6,{['AdductorLongus' Signe 'Pelvis'];['AdductorLongus' Signe 'Thigh']},{};...
    [Signe 'AdductorMagnus1'],345,0.087,18.8679,0.038935,5,{['AdductorMagnus' Signe 'Pelvis'];['AdductorMagnus1' Signe 'Thigh']},{};...
    [Signe 'AdductorMagnus2'],310,0.121,18.8679,0.059392,3,{['AdductorMagnus' Signe 'Pelvis'];['AdductorMagnus2' Signe 'Thigh']},{};...
    [Signe 'AdductorMagnus3'],445,0.131,18.8679,0.20688,5,{['AdductorMagnus' Signe 'Pelvis'];['AdductorMagnus3' Signe 'Thigh']},{};...
    [Signe 'QuadratusFemoris'],255,0.054,18.8679,0.04295,8,{['QuadratusFemoris' Signe 'Pelvis'];['QuadratusFemoris' Signe 'Thigh']},{};...
    [Signe 'AbductorBrevis'],285,0.133,18.8679,0.00866,0,{['AbductorBrevis' Signe 'Pelvis'];['AbductorBrevis' Signe 'Thigh']},{};...
    [Signe 'ObturatoriusInternus'],285,0.133,18.8679,0.005,0,{['ObturatoriusInternus' Signe 'Pelvis'];['ObturatoriusInternusVia' Signe 'Pelvis'];['ObturatoriusInternus' Signe 'Thigh']},{};...
    [Signe 'ObturatoriusExternus'],800,0.049,18.8679,0.05152,5,{['ObturatoriusExternus' Signe 'Pelvis'];['ObturatoriusExternus' Signe 'Thigh']},{};...
    [Signe 'Pictineus'],800,0.0474,18.8679,0.1122,5,{['Pictineus' Signe 'Pelvis'];['Pectineus' Signe 'Thigh']},{};...
    [Signe 'GemmelusInferior'],55,0.024,18.8679,0.099781,10,{['GemellusInferior' Signe 'Pelvis'];['GemellusInferior' Signe 'Thigh']},{};...
    [Signe 'GemmelusSuperior'],55,0.024,18.8679,0.09978,10,{['GemellusSuperior' Signe 'Pelvis'];['GemellusSuperior' Signe 'Thigh']},{};...
    [Signe 'GluteusMaximus3'],368,0.144,18.8679,0.081993,5,{['GluteusMaximus3' Signe 'Pelvis'];['GluteusMaximus3Via1' Signe 'Pelvis'];['GluteusMaximus3' Signe 'Thigh']},{};...
    [Signe 'Piriformis'],295,0.026,18.8679,0.1216,10,{['Piriformis' Signe 'Pelvis'];['PiriformisVia' Signe 'Pelvis'];['Piriformis' Signe 'Thigh']},{};...
    }];

% Knee
s=[s;{
    [Signe 'VastusLateralis'],1870,0.084,18.8679,0.27178,5,{['VastusLateralis' Signe 'Thigh'];['QuadricepsVia1' Signe 'Thigh'];['QuadricepsVia2' Signe 'Thigh'];['Quadriceps' Signe 'Shank']},{};...
    [Signe 'VastusMedialis'],1295,0.089,18.8679,0.3018,5,{['VastusMedialis' Signe 'Thigh'];['QuadricepsVia1' Signe 'Thigh'];['QuadricepsVia2' Signe 'Thigh'];['Quadriceps' Signe 'Shank']},{};...
    [Signe 'VastusIntermedius'],1235,0.1044,18.8679,0.2406,3,{['VastusIntermedius' Signe 'Thigh'];['QuadricepsVia1' Signe 'Thigh'];['QuadricepsVia2' Signe 'Thigh'];['Quadriceps' Signe 'Shank']},{};...
    [Signe 'RectusFemoris'],780,0.084,18.8679,0.517,5,{['RectusFemoris' Signe 'Pelvis'];['QuadricepsVia1' Signe 'Thigh'];['QuadricepsVia2' Signe 'Thigh'];['Quadriceps' Signe 'Shank']},{};...
    [Signe 'Semitendinosus'],330,0.201,18.8679,0.32977,5,{['Semitendinosus' Signe 'Pelvis'];['SemitendinosusVia' Signe 'Shank'];['Semitendinosus' Signe 'Shank']},{};...
    [Signe 'Semimembranosus'],1030,0.08,18.8679,0.38794,15,{['Semimembranosus' Signe 'Pelvis'];['SemimembranosusVia' Signe 'Shank'];['Semimembranosus' Signe 'Shank']},{};...
    [Signe 'BicepsFemorisCaputLongum'],720,0.11,18.8679,0.36979,0,{['BicepsFemorisCaputLongum' Signe 'Pelvis'];['BicepsFemorisCaputLongumVia' Signe 'Shank'];['BicepsFemorisCaputLongum' Signe 'Shank']},{};...
    [Signe 'BicepsFemorisCaputBreve'],400,0.173,18.8679,0.07297,23,{['BicepsFemorisCaputBreve' Signe 'Thigh'];['BicepsFemorisCaputBreveVia' Signe 'Shank'];['BicepsFemorisCaputBreve' Signe 'Shank']},{};...
    [Signe 'Sartorius'],104,0.579,18.8679,0.005,0,{['Sartorius' Signe 'Pelvis'];['SartoriusVia1' Signe 'Thigh'];['SartoriusVia2' Signe 'Shank'];['SartoriusVia3' Signe 'Shank'];['Sartorius' Signe 'Shank']},{};...
    [Signe 'Gracilis'],108,0.352,18.8679,0.14201,3,{['Gracilis' Signe 'Pelvis'];['GracilisVia' Signe 'Shank'];['GracilisVia1' Signe 'Shank'];['Gracilis' Signe 'Shank']},{};...
    [Signe 'GluteusMaximus1'],382,0.142,18.8679,0.46436,5,{['GluteusMaximus1' Signe 'Pelvis'];['GluteusMaximus1Via1' Signe 'Pelvis'];['GluteusMaximus1Via2' Signe 'Thigh'];['GluteusMaximus1' Signe 'Shank']},{};...
    [Signe 'GluteusMaximus2'],546,0.147,18.8679,0.44711,5,{['GluteusMaximus2' Signe 'Pelvis'];['GluteusMaximus2Via1' Signe 'Pelvis'];['GluteusMaximus2Via2' Signe 'Pelvis'];['GluteusMaximus2Via3' Signe 'Thigh'];['GluteusMaximus2' Signe 'Shank']},{};...
    [Signe 'TensorFasciaeLatae'],155,0.095,18.8679,0.45123,3,{['TensorFasciaeLatae' Signe 'Pelvis'];['TensorFasciaeLataeVia2' Signe 'Thigh'];['TensorFasciaeLatae' Signe 'Shank']},{};...
    }];

% Ankle
s=[s;{
    [Signe 'Soleus'],2830,0.04,18.8679,0.37736,25,{['Soleus' Signe 'Shank'];['Soleus' Signe 'Foot']},{};...
    [Signe 'Gastrocnemius'],1605,0.06,18.8679,0.44842,12,{['Gastrocnemius' Signe 'Thigh'];['GastrocnemiusVia' Signe 'Shank'];['Gastrocnemius' Signe 'Foot']},{};...
    [Signe 'FlexorDigitorumLongus'],310,0.06,18.8679,0.4289,7,{['FlexorDigitorumLongus' Signe 'Shank'];['FlexorDigitorumLongusVia' Signe 'Foot'];['FlexorDigitorumLongus' Signe 'Foot']},{};...
    [Signe 'FlexorHallucisLongus'],320,0.04,18.8679,0.39157,10,{['FlexorHallucisLongus' Signe 'Shank'];['FlexorHallucisLongusVia' Signe 'Foot'];['FlexorHallucisLongus' Signe 'Foot']},{};...
    [Signe 'TibialisPosterior'],1270,0.03,18.8679,0.45285,12,{['TibialisPosterior' Signe 'Shank'];['TibialisPosteriorVia' Signe 'Foot'];['TibialisPosterior' Signe 'Foot']},{};...
    [Signe 'PeroneusBrevis'],350,0.05,18.8679,0.24038,5,{['PeroneusBrevis' Signe 'Shank'];['PeroneusBrevisVia' Signe 'Foot'];['PeroneusBrevis' Signe 'Foot']},{};...
    [Signe 'TibialisAnterior'],600,0.056,18.8679,0.24996,5,{['TibialisAnterior' Signe 'Shank'];['TibialisAnteriorVia' Signe 'Foot'];['TibialisAnterior' Signe 'Foot']},{};...
    [Signe 'ExtensorDigitorumLongus'],340,0.1,18.8679,0.43991,8,{['ExtensorDigitorumLongus' Signe 'Shank'];['ExtensorDigitorumVia' Signe 'Foot'];['ExtensorDigitorumLongus' Signe 'Foot']},{};...
    [Signe 'ExtensorHallucisLongus'],110,0.11,18.8679,0.23895,6,{['ExtensorHallucisLongus' Signe 'Shank'];['ExtensorHallucisVia' Signe 'Foot'];['ExtensorHallucisLongus' Signe 'Foot']},{};...
    }];

% Structure generation
Muscles=[Muscles;struct('name',{s{:,1}}','f0',{s{:,2}}','l0',{s{:,3}}',...
    'Kt',{s{:,4}}','ls',{s{:,5}}','alpha0',{s{:,6}}','path',{s{:,7}}','wrap',{s{:,8}}')]; %#ok<CCAT1>

end