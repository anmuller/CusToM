function MomentsArmRegression=MomentsArmRegression_creation()

% All coeffs non explained come from 
% Ramsay, J. W., Hunter, B. V., & Gonzalez, R. V. (2009). 
% Muscle moment arm and normalized moment contributions as reference
% data for musculoskeletal elbow and wrist joint models. 
% Journal of Biomechanics, 42(4), 463–473. https://doi.org/10.1016/j.jbiomech.2008.11.035


k=0;

k=k+1;
%% TricepsBrachii1
MomentsArmRegression(k).name='TricepsBrachii1';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Ulna'};
MomentsArmRegression(k).regression(1).coeffs=[-24.5454 - 8.8691 9.3509 -1.7518 0]';

k=k+1;
%% TricepsBrachii2
MomentsArmRegression(k).name='TricepsBrachii2';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Ulna'};
MomentsArmRegression(k).regression(1).coeffs=[-24.5454 - 8.8691 9.3509 -1.7518 0]';

k=k+1;
%% BicepsBrachii1
MomentsArmRegression(k).name='BicepsBrachii1';
MomentsArmRegression(k).regression(1).equation='BVH2';
MomentsArmRegression(k).regression(1).joints={'Radius_J1','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[ 8.4533 36.6147 2.4777 -19.432 2.0571 13.6502 0 0 -5.6172 0 -2.0854 0 0 0 0 0 ]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Radius_J1'};
MomentsArmRegression(k).regression(2).coeffs=[ 1.7271 -4.1504 5.3103 -8.197 0.4405 1.0401 2.6866 -5.5137 0.6448 0 -1.0155 0 2.9534 0 -0.5583 0]';


k=k+1;
%% BicepsBrachii2
MomentsArmRegression(k).name='BicepsBrachii2';
MomentsArmRegression(k).regression(1).equation='BVH2';
MomentsArmRegression(k).regression(1).joints={'Radius_J1','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[ 8.4533 36.6147 2.4777 -19.432 2.0571 13.6502 0 0 -5.6172 0 -2.0854 0 0 0 0 0 ]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Radius_J1'};
MomentsArmRegression(k).regression(2).coeffs=[ 1.7271 -4.1504 5.3103 -8.197 0.4405 1.0401 2.6866 -5.5137 0.6448 0 -1.0155 0 2.9534 0 -0.5583 0]';


k=k+1;
%% Brachialis
MomentsArmRegression(k).name='Brachialis';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Radius_J1'};
MomentsArmRegression(k).regression(1).coeffs=[ 16.1991 -16.1463 24.5512 -6.3335 0 ]';

k=k+1;
%% Brachioradialis
MomentsArmRegression(k).name='Brachioradialis';
MomentsArmRegression(k).regression(1).equation='BVH2';
MomentsArmRegression(k).regression(1).joints={'Radius_J1','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[15.2564 -11.8355 2.8129 -5.7781 44.8143 0 2.9032 0 0 -13.4956 0 -0.3940 0 0 0 0]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Radius_J1'};
MomentsArmRegression(k).regression(2).coeffs=[ 3.8738 -3.1232 -2.3556 6.0596 7.9944 0.0973 -2.9923 -2.0882 -3.9195 -2.2210 -0.1293 0.4969 0.3683 1.3385 0.9909 -0.3279 ]';

k=k+1;
%% PronatorQuadrus
MomentsArmRegression(k).name='PronatorQuadrus';
MomentsArmRegression(k).regression(1).equation='BVH3';
MomentsArmRegression(k).regression(1).joints={'Ulna','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[11.0405 -1.0079 0.3933 -10.4824 -12.1639 -0.4369 36.9174 3.5232 -10.4223 21.2604 -37.2444 10.2666 -11.0060 14.5974 -3.9919 1.7526 -2.0089 0.5460 ]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Ulna'};
MomentsArmRegression(k).regression(2).coeffs=[ 5.0238 7.6939 -0.2566 0.9826 -3.3182 0 -0.3034  ]';

k=k+1;
%% SupinatorBrevis
MomentsArmRegression(k).name='SupinatorBrevis';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Radius'};
MomentsArmRegression(k).regression(1).coeffs=[ -13.8661 3.4337 ]';


k=k+1;
%% ExtensorCarpiRadialisBrevis
MomentsArmRegression(k).name='ExtensorCarpiRadialisBrevis';
MomentsArmRegression(k).regression(1).equation='BVH2';
MomentsArmRegression(k).regression(1).joints={'Radius_J1','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[ -11.256 17.8548 1.6398 -0.5073 -2.8827 0 -0.0942 ]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Radius_J1'};
MomentsArmRegression(k).regression(2).coeffs=[  0.2024 -0.9210 2.8116 -1.3039 ]';
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(3).coeffs=[ -13.4337 2.1411];
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).joints={'Hand'};
MomentsArmRegression(k).regression(4).coeffs=[ -8.9026 6.3445];

k=k+1;
%% ExtensorCarpiRadialisLongus
MomentsArmRegression(k).name='ExtensorCarpiRadialisLongus';
MomentsArmRegression(k).regression(1).equation='BVH2';
MomentsArmRegression(k).regression(1).joints={'Radius_J1','Radius'};
MomentsArmRegression(k).regression(1).coeffs=[ -7.7034 16.3913 7.4361 -1.7566 0 -1.3336 0 0.0742 ]';
MomentsArmRegression(k).regression(2).equation='BVH2';
MomentsArmRegression(k).regression(2).joints={'Radius','Radius_J1'};
MomentsArmRegression(k).regression(2).coeffs=[  -0.4621 -1.0054 6.5392 -2.3266 0 -0.5677 0 -0.0837]';
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(3).coeffs=[ -11.7166 2.2850];
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).joints={'Hand'};
MomentsArmRegression(k).regression(4).coeffs=[ -19.6240 5.5435];




k=k+1;
%% ExtensorCarpiUlnaris
MomentsArmRegression(k).name='ExtensorCarpiUlnaris';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(1).coeffs=[-8.5156 3.1064];
MomentsArmRegression(k).regression(2).equation='BVH1';
MomentsArmRegression(k).regression(2).joints={'Hand'};
MomentsArmRegression(k).regression(2).coeffs=[24.0633 3.8461];

% Data for elbowflexion
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[      0.00000000	
      1.31313131	
      2.62626263	
      3.93939394	
      5.25252526	
      6.56565657	
      7.87878789	
      9.19191920	
     10.50505052	
     11.81818183	
     13.13131315	
     14.44444446	
     15.75757577	
     17.07070709	
     18.38383840	
     19.69696972	
     21.01010103	
     22.32323235	
     23.63636366	
     24.94949498	
     26.26262629	
     27.57575761	
     28.88888892	
     30.20202023	
     31.51515155	
     32.82828286	
     34.14141418	
     35.45454549	
     36.76767681	
     38.08080812	
     39.39393944	
     40.70707075	
     42.02020206	
     43.33333338	
     44.64646469	
     45.95959601	
     47.27272732	
     48.58585864	
     49.89898995	
     51.21212127	
     52.52525258	
     53.83838390	
     55.15151521	
     56.46464652	
     57.77777784	
     59.09090915	
     60.40404047	
     61.71717178	
     63.03030310	
     64.34343441	
     65.65656573	
     66.96969704	
     68.28282836	
     69.59595967	
     70.90909098	
     72.22222230	
     73.53535361	
     74.84848493	
     76.16161624	
     77.47474756	
     78.78787887	
     80.10101019	
     81.41414150	
     82.72727282	
     84.04040413	
     85.35353544	
     86.66666676	
     87.97979807	
     89.29292939	
     90.60606070	
     91.91919202	
     93.23232333	
     94.54545465	
     95.85858596	
     97.17171727	
     98.48484859	
     99.79797990	
    101.11111122	
    102.42424253	
    103.73737385	
    105.05050516	
    106.36363648	
    107.67676779	
    108.98989911	
    110.30303042	
    111.61616173	
    112.92929305	
    114.24242436	
    115.55555568	
    116.86868699	
    118.18181831	
    119.49494962	
    120.80808094	
    122.12121225	
    123.43434357	
    124.74747488	
    126.06060619	
    127.37373751	
    128.68686882	
    130.00000014	]*pi/180;
y=[      0.00235977
      0.00240792
      0.00245504
      0.00250111
      0.00254611
      0.00259000
      0.00263277
      0.00267439
      0.00271484
      0.00275409
      0.00279212
      0.00282890
      0.00286442
      0.00289864
      0.00293154
      0.00296311
      0.00299332
      0.00302215
      0.00304957
      0.00307556
      0.00310011
      0.00312318
      0.00314477
      0.00316485
      0.00318340
      0.00320040
      0.00321584
      0.00322968
      0.00324193
      0.00325255
      0.00326154
      0.00326887
      0.00327453
      0.00327851
      0.00328078
      0.00328135
      0.00328019
      0.00327729
      0.00327264
      0.00326623
      0.00325806
      0.00324810
      0.00323636
      0.00322282
      0.00320749
      0.00319035
      0.00317141
      0.00315065
      0.00312808
      0.00310370
      0.00307751
      0.00304951
      0.00301970
      0.00298808
      0.00295467
      0.00291947
      0.00288249
      0.00284374
      0.00280323
      0.00276097
      0.00271698
      0.00267127
      0.00262386
      0.00257477
      0.00252402
      0.00247164
      0.00241764
      0.00236205
      0.00230490
      0.00224622
      0.00218603
      0.00212437
      0.00206128
      0.00199678
      0.00193092
      0.00186372
      0.00179524
      0.00172552
      0.00165459
      0.00158250
      0.00150929
      0.00143502
      0.00135973
      0.00128348
      0.00120630
      0.00112826
      0.00104941
      0.00096980
      0.00088949
      0.00080854
      0.00072699
      0.00064492
      0.00056238
      0.00047942
      0.00039612
      0.00031252
      0.00022870
      0.00014470
      0.00006060
     -0.00002354 ]*1e3 ;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(3).joints={'Radius_J1'};
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).coeffs=flip(p)';

% Data for elbowpronation
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[    -90.00000018	
    -88.18181836	
    -86.36363654	
    -84.54545472	
    -82.72727290	
    -80.90909107	
    -79.09090925	
    -77.27272743	
    -75.45454561	
    -73.63636379	
    -71.81818196	
    -70.00000014	
    -68.18181832	
    -66.36363650	
    -64.54545468	
    -62.72727286	
    -60.90909103	
    -59.09090921	
    -57.27272739	
    -55.45454557	
    -53.63636375	
    -51.81818192	
    -50.00000010	
    -48.18181828	
    -46.36363646	
    -44.54545464	
    -42.72727281	
    -40.90909099	
    -39.09090917	
    -37.27272735	
    -35.45454553	
    -33.63636370	
    -31.81818188	
    -30.00000006	
    -28.18181824	
    -26.36363642	
    -24.54545460	
    -22.72727277	
    -20.90909095	
    -19.09090913	
    -17.27272731	
    -15.45454549	
    -13.63636366	
    -11.81818184	
    -10.00000002	
     -8.18181820	
     -6.36363638	
     -4.54545455	
     -2.72727273	
     -0.90909091	
      0.90909091	
      2.72727273	
      4.54545455	
      6.36363638	
      8.18181820	
     10.00000002	
     11.81818184	
     13.63636366	
     15.45454549	
     17.27272731	
     19.09090913	
     20.90909095	
     22.72727277	
     24.54545460	
     26.36363642	
     28.18181824	
     30.00000006	
     31.81818188	
     33.63636370	
     35.45454553	
     37.27272735	
     39.09090917	
     40.90909099	
     42.72727281	
     44.54545464	
     46.36363646	
     48.18181828	
     50.00000010	
     51.81818192	
     53.63636375	
     55.45454557	
     57.27272739	
     59.09090921	
     60.90909103	
     62.72727286	
     64.54545468	
     66.36363650	
     68.18181832	
     70.00000014	
     71.81818196	
     73.63636379	
     75.45454561	
     77.27272743	
     79.09090925	
     80.90909107	
     82.72727290	
     84.54545472	
     86.36363654	
     88.18181836	
     90.00000018	]*pi/180;
y=[      0.00677585
      0.00680036
      0.00681754
      0.00682732
      0.00682964
      0.00682444
      0.00681169
      0.00679132
      0.00676332
      0.00672764
      0.00668428
      0.00663323
      0.00657448
      0.00650806
      0.00643398
      0.00635227
      0.00626300
      0.00616623
      0.00606203
      0.00595049
      0.00583173
      0.00570588
      0.00557308
      0.00543350
      0.00528731
      0.00513472
      0.00497595
      0.00481124
      0.00464084
      0.00446504
      0.00428413
      0.00409841
      0.00390823
      0.00371392
      0.00351583
      0.00331433
      0.00310981
      0.00290265
      0.00269323
      0.00248195
      0.00226920
      0.00205538
      0.00184088
      0.00162608
      0.00141134
      0.00119703
      0.00098351
      0.00077109
      0.00056010
      0.00035083
      0.00014356
     -0.00006147
     -0.00026401
     -0.00046386
     -0.00066084
     -0.00085478
     -0.00104555
     -0.00123302
     -0.00141711
     -0.00159774
     -0.00177486
     -0.00194844
     -0.00211846
     -0.00228492
     -0.00244784
     -0.00260723
     -0.00276315
     -0.00291563
     -0.00306472
     -0.00321050
     -0.00335302
     -0.00349234
     -0.00362853
     -0.00376165
     -0.00389176
     -0.00401892
     -0.00414316
     -0.00426453
     -0.00438306
     -0.00449877
     -0.00461166
     -0.00472175
     -0.00482900
     -0.00493339
     -0.00503487
     -0.00513340
     -0.00522890
     -0.00532129
     -0.00541047
     -0.00549633
     -0.00557876
     -0.00565761
     -0.00573275
     -0.00580403
     -0.00587128
     -0.00593433
     -0.00599302
     -0.00604716
     -0.00609659
     -0.00614111]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(4).joints={'Radius'};
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).coeffs=flip(p)';




k=k+1;
%% ExtensorDigitorum
MomentsArmRegression(k).name='ExtensorDigitorum';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(1).coeffs=[-14.1276 1.7325]';
MomentsArmRegression(k).regression(2).equation='BVH1';
MomentsArmRegression(k).regression(2).joints={'Hand'};
MomentsArmRegression(k).regression(2).coeffs=[2.0459 4.5732]';

% Data for elbowflexion
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[      0.00000000	
      1.31313131	
      2.62626263	
      3.93939394	
      5.25252526	
      6.56565657	
      7.87878789	
      9.19191920	
     10.50505052	
     11.81818183	
     13.13131315	
     14.44444446	
     15.75757577	
     17.07070709	
     18.38383840	
     19.69696972	
     21.01010103	
     22.32323235	
     23.63636366	
     24.94949498	
     26.26262629	
     27.57575761	
     28.88888892	
     30.20202023	
     31.51515155	
     32.82828286	
     34.14141418	
     35.45454549	
     36.76767681	
     38.08080812	
     39.39393944	
     40.70707075	
     42.02020206	
     43.33333338	
     44.64646469	
     45.95959601	
     47.27272732	
     48.58585864	
     49.89898995	
     51.21212127	
     52.52525258	
     53.83838390	
     55.15151521	
     56.46464652	
     57.77777784	
     59.09090915	
     60.40404047	
     61.71717178	
     63.03030310	
     64.34343441	
     65.65656573	
     66.96969704	
     68.28282836	
     69.59595967	
     70.90909098	
     72.22222230	
     73.53535361	
     74.84848493	
     76.16161624	
     77.47474756	
     78.78787887	
     80.10101019	
     81.41414150	
     82.72727282	
     84.04040413	
     85.35353544	
     86.66666676	
     87.97979807	
     89.29292939	
     90.60606070	
     91.91919202	
     93.23232333	
     94.54545465	
     95.85858596	
     97.17171727	
     98.48484859	
     99.79797990	
    101.11111122	
    102.42424253	
    103.73737385	
    105.05050516	
    106.36363648	
    107.67676779	
    108.98989911	
    110.30303042	
    111.61616173	
    112.92929305	
    114.24242436	
    115.55555568	
    116.86868699	
    118.18181831	
    119.49494962	
    120.80808094	
    122.12121225	
    123.43434357	
    124.74747488	
    126.06060619	
    127.37373751	
    128.68686882	
    130.00000014	]*pi/180;
y=[     -0.00966288
     -0.00971850
     -0.00976840
     -0.00981261
     -0.00985118
     -0.00988416
     -0.00991159
     -0.00993352
     -0.00995002
     -0.00996112
     -0.00996689
     -0.00996739
     -0.00996268
     -0.00995283
     -0.00993788
     -0.00991792
     -0.00989300
     -0.00986320
     -0.00982857
     -0.00978920
     -0.00974514
     -0.00969648
     -0.00964327
     -0.00958560
     -0.00952353
     -0.00945713
     -0.00938649
     -0.00931166
     -0.00923273
     -0.00914977
     -0.00906284
     -0.00897203
     -0.00887741
     -0.00877905
     -0.00867703
     -0.00857141
     -0.00846228
     -0.00834970
     -0.00823375
     -0.00811450
     -0.00799202
     -0.00786639
     -0.00773768
     -0.00760596
     -0.00747130
     -0.00733378
     -0.00719346
     -0.00705042
     -0.00690474
     -0.00675647
     -0.00660569
     -0.00645248
     -0.00629689
     -0.00613901
     -0.00597890
     -0.00581663
     -0.00565227
     -0.00548589
     -0.00531755
     -0.00514733
     -0.00497530
     -0.00480152
     -0.00462606
     -0.00444899
     -0.00427038
     -0.00409029
     -0.00390879
     -0.00372594
     -0.00354182
     -0.00335650
     -0.00317002
     -0.00298248
     -0.00279392
     -0.00260442
     -0.00241404
     -0.00222285
     -0.00203091
     -0.00183829
     -0.00164506
     -0.00145128
     -0.00125701
     -0.00106232
     -0.00086728
     -0.00067195
     -0.00047639
     -0.00028068
     -0.00008488
      0.00011096
      0.00030676
      0.00050245
      0.00069798
      0.00089327
      0.00108827
      0.00128291
      0.00147712
      0.00167083
      0.00186399
      0.00205652
      0.00224836
      0.00243945]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(3).joints={'Radius_J1'};
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).coeffs=flip(p)';



% Data for elbowpronation
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

 x=[    -90.00000018	
    -88.18181836	
    -86.36363654	
    -84.54545472	
    -82.72727290	
    -80.90909107	
    -79.09090925	
    -77.27272743	
    -75.45454561	
    -73.63636379	
    -71.81818196	
    -70.00000014	
    -68.18181832	
    -66.36363650	
    -64.54545468	
    -62.72727286	
    -60.90909103	
    -59.09090921	
    -57.27272739	
    -55.45454557	
    -53.63636375	
    -51.81818192	
    -50.00000010	
    -48.18181828	
    -46.36363646	
    -44.54545464	
    -42.72727281	
    -40.90909099	
    -39.09090917	
    -37.27272735	
    -35.45454553	
    -33.63636370	
    -31.81818188	
    -30.00000006	
    -28.18181824	
    -26.36363642	
    -24.54545460	
    -22.72727277	
    -20.90909095	
    -19.09090913	
    -17.27272731	
    -15.45454549	
    -13.63636366	
    -11.81818184	
    -10.00000002	
     -8.18181820	
     -6.36363638	
     -4.54545455	
     -2.72727273	
     -0.90909091	
      0.90909091	
      2.72727273	
      4.54545455	
      6.36363638	
      8.18181820	
     10.00000002	
     11.81818184	
     13.63636366	
     15.45454549	
     17.27272731	
     19.09090913	
     20.90909095	
     22.72727277	
     24.54545460	
     26.36363642	
     28.18181824	
     30.00000006	
     31.81818188	
     33.63636370	
     35.45454553	
     37.27272735	
     39.09090917	
     40.90909099	
     42.72727281	
     44.54545464	
     46.36363646	
     48.18181828	
     50.00000010	
     51.81818192	
     53.63636375	
     55.45454557	
     57.27272739	
     59.09090921	
     60.90909103	
     62.72727286	
     64.54545468	
     66.36363650	
     68.18181832	
     70.00000014	
     71.81818196	
     73.63636379	
     75.45454561	
     77.27272743	
     79.09090925	
     80.90909107	
     82.72727290	
     84.54545472	
     86.36363654	
     88.18181836	 
     90.00000018	]*pi/180;
y=[      0.00093931
      0.00097979
      0.00101934
      0.00105793
      0.00109551
      0.00113207
      0.00116754
      0.00120191
      0.00123513
      0.00126718
      0.00129801
      0.00132760
      0.00135592
      0.00138293
      0.00140861
      0.00143293
      0.00145586
      0.00147738
      0.00149746
      0.00151608
      0.00153322
      0.00154885
      0.00156296
      0.00157554
      0.00158656
      0.00159600
      0.00160386
      0.00161013
      0.00161479
      0.00161783
      0.00161926
      0.00161905
      0.00161721
      0.00161373
      0.00160862
      0.00160187
      0.00159349
      0.00158348
      0.00157184
      0.00155860
      0.00154374
      0.00152729
      0.00150926
      0.00148966
      0.00146851
      0.00144583
      0.00142164
      0.00139595
      0.00136880
      0.00134021
      0.00131020
      0.00127880
      0.00124605
      0.00121197
      0.00117660
      0.00113997
      0.00110213
      0.00106310
      0.00102293
      0.00098166
      0.00093934
      0.00089600
      0.00085169
      0.00080646
      0.00076035
      0.00071342
      0.00066572
      0.00061728
      0.00056818
      0.00051846
      0.00046817
      0.00041737
      0.00036611
      0.00031445
      0.00026245
      0.00021016
      0.00015763
      0.00010494
      0.00005213
     -0.00000073
     -0.00005360
     -0.00010640
     -0.00015909
     -0.00021161
     -0.00026389
     -0.00031589
     -0.00036753
     -0.00041878
     -0.00046957
     -0.00051984
     -0.00056955
     -0.00061864
     -0.00066705
     -0.00071473
     -0.00076164
     -0.00080772
     -0.00085293
     -0.00089721
     -0.00094053
     -0.00098282]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(4).joints={'Radius'};
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).coeffs=flip(p)';





k=k+1;
%% FlexorCarpiRadialis
MomentsArmRegression(k).name='FlexorCarpiRadialis';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(1).coeffs=[13.2040 1.5995]';
MomentsArmRegression(k).regression(2).equation='BVH1';
MomentsArmRegression(k).regression(2).joints={'Hand'};
MomentsArmRegression(k).regression(2).coeffs=[-10.1898 5.5019]';

% Data for elbowflexion
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[      0.00000000	
      1.31313131	
      2.62626263	
      3.93939394	
      5.25252526	
      6.56565657	
      7.87878789	
      9.19191920	
     10.50505052	
     11.81818183	
     13.13131315	
     14.44444446	
     15.75757577	
     17.07070709	
     18.38383840	
     19.69696972	
     21.01010103	
     22.32323235	
     23.63636366	
     24.94949498	
     26.26262629	
     27.57575761	
     28.88888892	
     30.20202023	
     31.51515155	
     32.82828286	
     34.14141418	
     35.45454549	
     36.76767681	
     38.08080812	
     39.39393944	
     40.70707075	
     42.02020206	
     43.33333338	
     44.64646469	
     45.95959601	
     47.27272732	
     48.58585864	
     49.89898995	
     51.21212127	
     52.52525258	
     53.83838390	
     55.15151521	
     56.46464652	
     57.77777784	
     59.09090915	
     60.40404047	
     61.71717178	
     63.03030310	
     64.34343441	
     65.65656573	
     66.96969704	
     68.28282836	
     69.59595967	
     70.90909098	
     72.22222230	
     73.53535361	
     74.84848493	
     76.16161624	
     77.47474756	
     78.78787887	
     80.10101019	
     81.41414150	
     82.72727282	
     84.04040413	
     85.35353544	
     86.66666676	
     87.97979807	
     89.29292939	
     90.60606070	
     91.91919202	
     93.23232333	
     94.54545465	
     95.85858596	
     97.17171727	
     98.48484859	
     99.79797990	
    101.11111122	
    102.42424253	
    103.73737385	
    105.05050516	
    106.36363648	
    107.67676779	
    108.98989911	
    110.30303042	
    111.61616173	
    112.92929305	
    114.24242436	
    115.55555568	
    116.86868699	
    118.18181831	
    119.49494962	
    120.80808094	
    122.12121225	
    123.43434357	
    124.74747488	
    126.06060619	
    127.37373751	
    128.68686882	
    130.00000014	]*pi/180;
y=[     -0.00029096
     -0.00025752
     -0.00022394
     -0.00019024
     -0.00015645
     -0.00012257
     -0.00008863
     -0.00005465
     -0.00002064
      0.00001338
      0.00004740
      0.00008139
      0.00011534
      0.00014922
      0.00018304
      0.00021675
      0.00025036
      0.00028384
      0.00031717
      0.00035033
      0.00038332
      0.00041611
      0.00044868
      0.00048102
      0.00051312
      0.00054495
      0.00057649
      0.00060774
      0.00063868
      0.00066929
      0.00069955
      0.00072944
      0.00075897
      0.00078809
      0.00081682
      0.00084512
      0.00087298
      0.00090039
      0.00092733
      0.00095380
      0.00097977
      0.00100523
      0.00103017
      0.00105458
      0.00107844
      0.00110174
      0.00112448
      0.00114662
      0.00116817
      0.00118912
      0.00120945
      0.00122915
      0.00124821
      0.00126662
      0.00128437
      0.00130146
      0.00131786
      0.00133358
      0.00134861
      0.00136293
      0.00137655
      0.00138944
      0.00140161
      0.00141305
      0.00142375
      0.00143371
      0.00144292
      0.00145137
      0.00145907
      0.00146600
      0.00147216
      0.00147756
      0.00148218
      0.00148602
      0.00148908
      0.00149137
      0.00149287
      0.00149358
      0.00149351
      0.00149266
      0.00149103
      0.00148861
      0.00148540
      0.00148142
      0.00147665
      0.00147111
      0.00146479
      0.00145770
      0.00144984
      0.00144121
      0.00143183
      0.00142169
      0.00141080
      0.00139916
      0.00138678
      0.00137367
      0.00135984
      0.00134528
      0.00133001
      0.00131404]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(3).joints={'Radius_J1'};
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).coeffs=flip(p)';


% Data for elbowpronation
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[    -90.00000018	
    -88.18181836	
    -86.36363654	
    -84.54545472	
    -82.72727290	
    -80.90909107	
    -79.09090925	
    -77.27272743	
    -75.45454561	
    -73.63636379	
    -71.81818196	
    -70.00000014	
    -68.18181832	
    -66.36363650	
    -64.54545468	
    -62.72727286	
    -60.90909103	
    -59.09090921	
    -57.27272739	
    -55.45454557	
    -53.63636375	
    -51.81818192	
    -50.00000010	
    -48.18181828	
    -46.36363646	
    -44.54545464	
    -42.72727281	
    -40.90909099	
    -39.09090917	
    -37.27272735	
    -35.45454553	
    -33.63636370	
    -31.81818188	
    -30.00000006	
    -28.18181824	
    -26.36363642	
    -24.54545460	
    -22.72727277	
    -20.90909095	
    -19.09090913	
    -17.27272731	
    -15.45454549	
    -13.63636366	
    -11.81818184	
    -10.00000002	
     -8.18181820	
     -6.36363638	
     -4.54545455	
     -2.72727273	
     -0.90909091	
      0.90909091	
      2.72727273	
      4.54545455	
      6.36363638	
      8.18181820	
     10.00000002	
     11.81818184	
     13.63636366	
     15.45454549	
     17.27272731	
     19.09090913	
     20.90909095	
     22.72727277	
     24.54545460	
     26.36363642	
     28.18181824	
     30.00000006	
     31.81818188	
     33.63636370	
     35.45454553	
     37.27272735	
     39.09090917	
     40.90909099	
     42.72727281	
     44.54545464	
     46.36363646	
     48.18181828	
     50.00000010	
     51.81818192	
     53.63636375	
     55.45454557	
     57.27272739	
     59.09090921	
     60.90909103	
     62.72727286	
     64.54545468	
     66.36363650	
     68.18181832	
     70.00000014	
     71.81818196	
     73.63636379	
     75.45454561	
     77.27272743	
     79.09090925	
     80.90909107	
     82.72727290	
     84.54545472	
     86.36363654	
     88.18181836	
     90.00000018	]*pi/180;
y=[     -0.00260925
     -0.00246240
     -0.00231322
     -0.00216185
     -0.00200842
     -0.00185310
     -0.00169601
     -0.00153733
     -0.00137719
     -0.00121575
     -0.00105316
     -0.00088958
     -0.00072516
     -0.00056005
     -0.00039441
     -0.00022841
     -0.00006219
      0.00010409
      0.00027028
      0.00043620
      0.00060172
      0.00076667
      0.00093089
      0.00109424
      0.00125655
      0.00141768
      0.00157747
      0.00173576
      0.00189242
      0.00204728
      0.00220020
      0.00235104
      0.00249964
      0.00264587
      0.00278959
      0.00293065
      0.00306891
      0.00320425
      0.00333653
      0.00346562
      0.00359139
      0.00371372
      0.00383248
      0.00394756
      0.00405883
      0.00416619
      0.00426953
      0.00436873
      0.00446371
      0.00455434
      0.00464055
      0.00472224
      0.00479932
      0.00487171
      0.00493933
      0.00500210
      0.00505995
      0.00511281
      0.00516063
      0.00520334
      0.00524090
      0.00527325
      0.00530035
      0.00532216
      0.00533866
      0.00534981
      0.00535559
      0.00535599
      0.00535099
      0.00534058
      0.00532477
      0.00530355
      0.00527695
      0.00524497
      0.00520764
      0.00516499
      0.00511704
      0.00506383
      0.00500541
      0.00494183
      0.00487315
      0.00479942
      0.00472071
      0.00463710
      0.00454866
      0.00445547
      0.00435763
      0.00425522
      0.00414835
      0.00403713
      0.00392165
      0.00380205
      0.00367843
      0.00355092
      0.00341965
      0.00328475
      0.00314637
      0.00300464
      0.00285971
      0.00271174]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(4).joints={'Radius'};
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).coeffs=flip(p)';





k=k+1;
%% FlexorCarpiUlnaris
MomentsArmRegression(k).name='FlexorCarpiUlnaris';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(1).coeffs=[11.2147 4.6725 1.3307]';
MomentsArmRegression(k).regression(2).equation='BVH1';
MomentsArmRegression(k).regression(2).joints={'Hand'};
MomentsArmRegression(k).regression(2).coeffs=[19.6193 13.2905]';

% Data for elbowflexion
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[      0.00000000	
      1.31313131	
      2.62626263	
      3.93939394	
      5.25252526	
      6.56565657	
      7.87878789	
      9.19191920	
     10.50505052	
     11.81818183	
     13.13131315	
     14.44444446	
     15.75757577	
     17.07070709	
     18.38383840	
     19.69696972	
     21.01010103	
     22.32323235	
     23.63636366	
     24.94949498	
     26.26262629	
     27.57575761	
     28.88888892	
     30.20202023	
     31.51515155	
     32.82828286	
     34.14141418	
     35.45454549	
     36.76767681	
     38.08080812	
     39.39393944	
     40.70707075	
     42.02020206	
     43.33333338	
     44.64646469	
     45.95959601	
     47.27272732	
     48.58585864	
     49.89898995	
     51.21212127	
     52.52525258	
     53.83838390	
     55.15151521	
     56.46464652	
     57.77777784	
     59.09090915	
     60.40404047	
     61.71717178	
     63.03030310	
     64.34343441	
     65.65656573	
     66.96969704	
     68.28282836	
     69.59595967	
     70.90909098	
     72.22222230	
     73.53535361	
     74.84848493	
     76.16161624	
     77.47474756	
     78.78787887	
     80.10101019	
     81.41414150	
     82.72727282	
     84.04040413	
     85.35353544	
     86.66666676	
     87.97979807	
     89.29292939	
     90.60606070	
     91.91919202	
     93.23232333	
     94.54545465	
     95.85858596	
     97.17171727	
     98.48484859	
     99.79797990	
    101.11111122	
    102.42424253	
    103.73737385	
    105.05050516	
    106.36363648	
    107.67676779	
    108.98989911	
    110.30303042	
    111.61616173	
    112.92929305	
    114.24242436	
    115.55555568	
    116.86868699	
    118.18181831	
    119.49494962	
    120.80808094	
    122.12121225	
    123.43434357	
    124.74747488	
    126.06060619	
    127.37373751	
    128.68686882	
    130.00000014	]*pi/180;
y=[     -0.00203012
     -0.00199903
     -0.00196690
     -0.00193376
     -0.00189962
     -0.00186450
     -0.00182842
     -0.00179139
     -0.00175344
     -0.00171459
     -0.00167485
     -0.00163425
     -0.00159281
     -0.00155055
     -0.00150749
     -0.00146366
     -0.00141907
     -0.00137376
     -0.00132774
     -0.00128103
     -0.00123367
     -0.00118568
     -0.00113708
     -0.00108789
     -0.00103815
     -0.00098788
     -0.00093710
     -0.00088584
     -0.00083412
     -0.00078198
     -0.00072944
     -0.00067652
     -0.00062326
     -0.00056968
     -0.00051581
     -0.00046167
     -0.00040730
     -0.00035272
     -0.00029796
     -0.00024305
     -0.00018801
     -0.00013288
     -0.00007768
     -0.00002244
      0.00003281
      0.00008805
      0.00014324
      0.00019836
      0.00025337
      0.00030826
      0.00036299
      0.00041753
      0.00047186
      0.00052595
      0.00057977
      0.00063329
      0.00068649
      0.00073934
      0.00079181
      0.00084387
      0.00089550
      0.00094667
      0.00099736
      0.00104754
      0.00109718
      0.00114625
      0.00119474
      0.00124262
      0.00128986
      0.00133643
      0.00138232
      0.00142750
      0.00147195
      0.00151564
      0.00155855
      0.00160066
      0.00164194
      0.00168238
      0.00172196
      0.00176064
      0.00179842
      0.00183527
      0.00187117
      0.00190611
      0.00194006
      0.00197301
      0.00200495
      0.00203584
      0.00206568
      0.00209445
      0.00212213
      0.00214872
      0.00217419
      0.00219853
      0.00222174
      0.00224378
      0.00226466
      0.00228437
      0.00230288    
      0.00232020];

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(3).joints={'Radius_J1'};
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).coeffs=flip(p)';

% Data for elbowpronation
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[    -90.00000018	
    -88.18181836	
    -86.36363654	
    -84.54545472	
    -82.72727290	
    -80.90909107	
    -79.09090925	
    -77.27272743	
    -75.45454561	
    -73.63636379	
    -71.81818196	
    -70.00000014	
    -68.18181832	
    -66.36363650	
    -64.54545468	
    -62.72727286	
    -60.90909103	
    -59.09090921	
    -57.27272739	
    -55.45454557	
    -53.63636375	
    -51.81818192	
    -50.00000010	
    -48.18181828	
    -46.36363646	
    -44.54545464	
    -42.72727281	
    -40.90909099	
    -39.09090917	
    -37.27272735	
    -35.45454553	
    -33.63636370	
    -31.81818188	
    -30.00000006	
    -28.18181824	
    -26.36363642	
    -24.54545460	
    -22.72727277	
    -20.90909095	
    -19.09090913	
    -17.27272731	
    -15.45454549	
    -13.63636366	
    -11.81818184	
    -10.00000002	
     -8.18181820	
     -6.36363638	
     -4.54545455	
     -2.72727273	
     -0.90909091	
      0.90909091	
      2.72727273	
      4.54545455	
      6.36363638	
      8.18181820	
     10.00000002	
     11.81818184	
     13.63636366	
     15.45454549	
     17.27272731	
     19.09090913	
     20.90909095	
     22.72727277	
     24.54545460	
     26.36363642	
     28.18181824	
     30.00000006	
     31.81818188	
     33.63636370	
     35.45454553	
     37.27272735	
     39.09090917	
     40.90909099	
     42.72727281	
     44.54545464	
     46.36363646	
     48.18181828	
     50.00000010	
     51.81818192	
     53.63636375	
     55.45454557	
     57.27272739	
     59.09090921	
     60.90909103	
     62.72727286	
     64.54545468	
     66.36363650	
     68.18181832	
     70.00000014	
     71.81818196	
     73.63636379	
     75.45454561	
     77.27272743	
     79.09090925	
     80.90909107	
     82.72727290	
     84.54545472	
     86.36363654	
     88.18181836	
     90.00000018	 ]*pi/180;
y=[      0.00059642
      0.00066451
      0.00073194
      0.00079866
      0.00086459
      0.00092967
      0.00099384
      0.00105703
      0.00111917
      0.00118022
      0.00124010
      0.00129875
      0.00135613
      0.00141216
      0.00146681
      0.00152000
      0.00157169
      0.00162182
      0.00167035
      0.00171723
      0.00176240
      0.00180583
      0.00184747
      0.00188727
      0.00192520
      0.00196121
      0.00199527
      0.00202735
      0.00205741
      0.00208542
      0.00211134
      0.00213516
      0.00215685
      0.00217638
      0.00219373
      0.00220889
      0.00222183
      0.00223255
      0.00224102
      0.00224725
      0.00225121
      0.00225291
      0.00225235
      0.00224951
      0.00224440
      0.00223703
      0.00222741
      0.00221553
      0.00220141
      0.00218506
      0.00216649
      0.00214573
      0.00212280
      0.00209770
      0.00207048
      0.00204115
      0.00200975
      0.00197629
      0.00194083
      0.00190338
      0.00186399
      0.00182270
      0.00177955
      0.00173457
      0.00168782
      0.00163935
      0.00158919
      0.00153741
      0.00148405
      0.00142916
      0.00137281
      0.00131505
      0.00125594
      0.00119553
      0.00113390
      0.00107110
      0.00100720
      0.00094226
      0.00087635
      0.00080954
      0.00074189
      0.00067348
      0.00060437
      0.00053464
      0.00046436
      0.00039359
      0.00032243
      0.00025093
      0.00017917
      0.00010722
      0.00003517
     -0.00003692
     -0.00010898
     -0.00018092
     -0.00025267
     -0.00032416
     -0.00039532
     -0.00046607
     -0.00053634
     -0.00060606]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(4).joints={'Radius'};
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).coeffs=flip(p)';





k=k+1;
%% FlexorDigitorumSuperior
MomentsArmRegression(k).name='FlexorDigitorumSuperior';
MomentsArmRegression(k).regression(1).equation='BVH1';
MomentsArmRegression(k).regression(1).joints={'Wrist_J1'};
MomentsArmRegression(k).regression(2).equation='BVH1';
MomentsArmRegression(k).regression(2).joints={'Hand'};
MomentsArmRegression(k).regression(1).coeffs=[10.3467 1.0641 1.0495]';
MomentsArmRegression(k).regression(2).coeffs=[1.6252 6.3604]';

% Data for elbowflexion
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim


x=[      0.00000000	
      1.31313131	
      2.62626263	
      3.93939394	
      5.25252526	
      6.56565657	
      7.87878789	
      9.19191920	
     10.50505052	
     11.81818183	
     13.13131315	
     14.44444446	
     15.75757577	
     17.07070709	
     18.38383840	
     19.69696972	
     21.01010103	
     22.32323235	
     23.63636366	
     24.94949498	
     26.26262629	
     27.57575761	
     28.88888892	
     30.20202023	
     31.51515155	
     32.82828286	
     34.14141418	
     35.45454549	
     36.76767681	
     38.08080812	
     39.39393944	
     40.70707075	
     42.02020206	
     43.33333338	
     44.64646469	
     45.95959601	
     47.27272732	
     48.58585864	
     49.89898995	
     51.21212127	
     52.52525258	
     53.83838390	
     55.15151521	
     56.46464652	
     57.77777784	
     59.09090915	
     60.40404047	
     61.71717178	
     63.03030310	
     64.34343441	
     65.65656573	
     66.96969704	
     68.28282836	
     69.59595967	
     70.90909098	
     72.22222230	
     73.53535361	
     74.84848493	
     76.16161624	
     77.47474756	
     78.78787887	
     80.10101019	
     81.41414150	
     82.72727282	
     84.04040413	
     85.35353544	
     86.66666676	
     87.97979807	
     89.29292939	
     90.60606070	
     91.91919202	
     93.23232333	
     94.54545465	
     95.85858596	
     97.17171727	
     98.48484859	
     99.79797990	
    101.11111122	
    102.42424253	
    103.73737385	
    105.05050516	
    106.36363648	
    107.67676779	
    108.98989911	
    110.30303042	
    111.61616173	
    112.92929305	
    114.24242436	
    115.55555568	
    116.86868699	
    118.18181831	
    119.49494962	
    120.80808094	
    122.12121225	
    123.43434357	
    124.74747488	
    126.06060619	
    127.37373751	
    128.68686882	
    130.00000014	]*pi/180;
y=[     -0.00636158
     -0.00681809
     -0.00727020
     -0.00771764
     -0.00816012
     -0.00859738
     -0.00902914
     -0.00945515
     -0.00987514
     -0.01028888
     -0.01069610
     -0.01109659
     -0.01149010
     -0.01187641
     -0.01225529
     -0.01262655
     -0.01298998
     -0.01334537
     -0.01369254
     -0.01403130
     -0.01436148
     -0.01468291
     -0.01499543
     -0.01529889
     -0.01559314
     -0.01587804
     -0.01615346
     -0.01641927
     -0.01667537
     -0.01692164
     -0.01715798
     -0.01738430
     -0.01760052
     -0.01780654
     -0.01800231
     -0.01818776
     -0.01836282
     -0.01852745
     -0.01868161
     -0.01882526
     -0.01895836
     -0.01908090
     -0.01919286
     -0.01929423
     -0.01938500
     -0.01946517
     -0.01953476
     -0.01959378
     -0.01964225
     -0.01968019
     -0.01970763
     -0.01972462
     -0.01973118
     -0.01972738
     -0.01971326
     -0.01968888
     -0.01965430
     -0.01960959
     -0.01955481
     -0.01949005
     -0.01941538
     -0.01933089
     -0.01923666
     -0.01913279
     -0.01901938
     -0.01889652
     -0.01876431
     -0.01862286
     -0.01847228
     -0.01831269
     -0.01814420
     -0.01796693
     -0.01778100
     -0.01758654
     -0.01738367
     -0.01717253
     -0.01695325
     -0.01672595
     -0.01649079
     -0.01624790
     -0.01599742
     -0.01573950
     -0.01547427
     -0.01520190
     -0.01492254
     -0.01463632
     -0.01434341
     -0.01404396
     -0.01373812
     -0.01342607
     -0.01310794
     -0.01278392
     -0.01245415
     -0.01211881
     -0.01177805
     -0.01143204
     -0.01108096
     -0.01072496
     -0.01036422
     -0.00999891]*1e3;

p=polyfit(x,y,3);
MomentsArmRegression(k).regression(3).joints={'Radius_J1'};
MomentsArmRegression(k).regression(3).equation='BVH1';
MomentsArmRegression(k).regression(3).coeffs=flip(p)';

% Data for elbowpronation
% Taken from Gonzalez, R. V., Buchanan, T. S., & Delp, S. L. (1997). How muscle architecture and moment arms affect wrist flexion-extension moments. Journal of Biomechanics, 30(7), 705–712. https://doi.org/10.1016/S0021-9290(97)00015-8
% From measures in OpenSim

x=[    -90.00000018	
    -88.18181836	
    -86.36363654	
    -84.54545472	
    -82.72727290	
    -80.90909107	
    -79.09090925	
    -77.27272743	
    -75.45454561	
    -73.63636379	
    -71.81818196	
    -70.00000014	
    -68.18181832	
    -66.36363650	
    -64.54545468	
    -62.72727286	
    -60.90909103	
    -59.09090921	
    -57.27272739	
    -55.45454557	
    -53.63636375	
    -51.81818192	
    -50.00000010	
    -48.18181828	
    -46.36363646	
    -44.54545464	
    -42.72727281	
    -40.90909099	
    -39.09090917	
    -37.27272735	
    -35.45454553	
    -33.63636370	
    -31.81818188	
    -30.00000006	
    -28.18181824	
    -26.36363642	
    -24.54545460	
    -22.72727277	
    -20.90909095	
    -19.09090913	
    -17.27272731	
    -15.45454549	
    -13.63636366	
    -11.81818184	
    -10.00000002	
     -8.18181820	
     -6.36363638	
     -4.54545455	
     -2.72727273	
     -0.90909091	
      0.90909091	
      2.72727273	
      4.54545455	
      6.36363638	
      8.18181820	
     10.00000002	
     11.81818184	
     13.63636366	
     15.45454549	
     17.27272731	
     19.09090913	
     20.90909095	
     22.72727277	
     24.54545460	
     26.36363642	
     28.18181824	
     30.00000006	
     31.81818188	
     33.63636370	
     35.45454553	
     37.27272735	
     39.09090917	
     40.90909099	
     42.72727281	
     44.54545464	
     46.36363646	
     48.18181828	
     50.00000010	
     51.81818192	
     53.63636375	
     55.45454557	
     57.27272739	
     59.09090921	
     60.90909103	
     62.72727286	
     64.54545468	
     66.36363650	
     68.18181832	
     70.00000014	
     71.81818196	
     73.63636379	
     75.45454561	
     77.27272743	
     79.09090925	
     80.90909107	
     82.72727290	
     84.54545472	
     86.36363654	
     88.18181836	
     90.00000018	]*pi/180;

y=[     -0.00192509
     -0.00184184
     -0.00175679
     -0.00167002
     -0.00158162
     -0.00149169
     -0.00140030
     -0.00130754
     -0.00121352
     -0.00111831
     -0.00102202
     -0.00092473
     -0.00082654
     -0.00072756
     -0.00062786
     -0.00052756
     -0.00042674
     -0.00032551
     -0.00022397
     -0.00012220
     -0.00002032
      0.00008158
      0.00018340
      0.00028505
      0.00038641
      0.00048741
      0.00058793
      0.00068788
      0.00078716
      0.00088567
      0.00098333
      0.00108003
      0.00117568
      0.00127019
      0.00136346
      0.00145541
      0.00154593
      0.00163496
      0.00172238
      0.00180813
      0.00189211
      0.00197425
      0.00205445
      0.00213264
      0.00220875
      0.00228269
      0.00235440
      0.00242379
      0.00249081
      0.00255537
      0.00261742
      0.00267690
      0.00273373
      0.00278787
      0.00283925
      0.00288783
      0.00293355
      0.00297636
      0.00301622
      0.00305308
      0.00308691
      0.00311767
      0.00314532
      0.00316984
      0.00319119
      0.00320935
      0.00322430
      0.00323601
      0.00324448
      0.00324969
      0.00325164
      0.00325031
      0.00324570
      0.00323782
      0.00322667
      0.00321225
      0.00319458
      0.00317367
      0.00314953
      0.00312220
      0.00309169
      0.00305803
      0.00302125
      0.00298139
      0.00293848
      0.00289256
      0.00284368
      0.00279188
      0.00273722
      0.00267974
      0.00261951
      0.00255658
      0.00249102
      0.00242288
      0.00235225
      0.00227918
      0.00220375
      0.00212605
      0.00204614
      0.00196411]*1e3;

p=polyfit(x,y,3);


MomentsArmRegression(k).regression(4).joints={'Radius'};
MomentsArmRegression(k).regression(4).equation='BVH1';
MomentsArmRegression(k).regression(4).coeffs=flip(p)';





end